(multimodal-emotion) D:\research\2025_iris_taufik\MultimodalEmoLearn-CNN-LSTM>python src\training\optimized_train_cnn.py
2025-05-22 12:23:42.237149: I tensorflow/c/logging.cc:34] Successfully opened dynamic library C:\Users\fitra\miniconda3\envs\multimodal-emotion\lib\site-packages\tensorflow-plugins/directml/directml.d6f03b303ac3c4f2eeb8ca631688c9757b361310.dll
2025-05-22 12:23:42.245123: I tensorflow/c/logging.cc:34] Successfully opened dynamic library dxgi.dll
2025-05-22 12:23:42.248248: I tensorflow/c/logging.cc:34] Successfully opened dynamic library d3d12.dll
2025-05-22 12:23:42.663761: I tensorflow/c/logging.cc:34] DirectML device enumeration: found 2 compatible adapters.
🎮 Setting up AMD RX 6600 LE...
✅ Found 2 GPU device(s)
✅ GPU memory growth enabled
2025-05-22 12:23:44.179714: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-22 12:23:44.180352: I tensorflow/c/logging.cc:34] DirectML: creating device on adapter 0 (AMD Radeon RX 6600 LE)
2025-05-22 12:23:44.264771: I tensorflow/c/logging.cc:34] Successfully opened dynamic library Kernel32.dll
2025-05-22 12:23:44.267280: I tensorflow/c/logging.cc:34] DirectML: creating device on adapter 1 (AMD Radeon 780M Graphics)
2025-05-22 12:23:44.314281: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:306] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.
2025-05-22 12:23:44.314365: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:306] Could not identify NUMA node of platform GPU ID 1, defaulting to 0. Your kernel may not have been built with NUMA support.
2025-05-22 12:23:44.314490: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:272] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 35885 MB memory) -> physical PluggableDevice (device: 0, name: DML, pci bus id: <undefined>)
2025-05-22 12:23:44.315246: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:272] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 30778 MB memory) -> physical PluggableDevice (device: 1, name: DML, pci bus id: <undefined>)
✅ GPU computation test passed
✅ XLA compilation enabled
🚀 GPU Mode: Batch size 32, 50 epochs
📁 Loading data...
✅ Data loaded successfully!
Training samples: 3,123
Validation samples: 390
Test samples: 391
Image shape: (224, 224, 3)
🏷️ Processing labels...
Number of classes: 6
Classes: ['angry', 'disgusted', 'happy', 'neutral', 'sad', 'surprised']
✅ Label preprocessing completed
⚙️ Setting up callbacks...
🚀 Training CNN model on GPU...
============================================================
📊 Model Summary:
Total Parameters: 27,002,662
Traceback (most recent call last):
  File "D:\research\2025_iris_taufik\MultimodalEmoLearn-CNN-LSTM\src\training\optimized_train_cnn.py", line 243, in <module>
    print(f"Trainable Parameters: {sum([tf.keras.utils.count_params(w) for w in cnn_model.trainable_weights]):,}")
  File "D:\research\2025_iris_taufik\MultimodalEmoLearn-CNN-LSTM\src\training\optimized_train_cnn.py", line 243, in <listcomp>
    print(f"Trainable Parameters: {sum([tf.keras.utils.count_params(w) for w in cnn_model.trainable_weights]):,}")
AttributeError: module 'tensorflow.keras.utils' has no attribute 'count_params'